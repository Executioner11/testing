--!strict
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

local TEXT_COLOR = Color3.fromRGB(255,255,255)
local SLIDER_COLOR = Color3.fromRGB(100,200,255)
local SLIDER_BG_COLOR = Color3.fromRGB(60,60,60)
local BUTTON_COLOR = Color3.fromRGB(80,80,80)

local UI = Instance.new("ScreenGui")
UI.Name = "FluentNockoff"
UI.ResetOnSpawn = false
UI.Parent = PlayerGui

local Windows = {}
local Notifications = {}

local function tween(obj, props, time, style, dir)
	return TweenService:Create(obj, TweenInfo.new(time, style, dir), props)
end

-- Utility: create rounded frame
local function createRoundedFrame(parent, size, pos, bgColor, bgTransparency, cornerRadius)
	local frame = Instance.new("Frame")
	frame.Size = size
	frame.Position = pos
	frame.BackgroundColor3 = bgColor
	frame.BackgroundTransparency = bgTransparency or 0
	frame.BorderSizePixel = 0
	frame.Parent = parent

	local corner = Instance.new("UICorner")
	corner.CornerRadius = cornerRadius or UDim.new(0,10)
	corner.Parent = frame

	return frame
end

-- Window
local function createWindow(title)
	local Window = createRoundedFrame(UI, UDim2.new(0,450,0,300), UDim2.new(0.5,-225,0.5,-150), Color3.fromRGB(0,0,0), 0.15, UDim.new(0,10))

	-- Title Bar
	local TitleBar = createRoundedFrame(Window, UDim2.new(1,0,0,30), UDim2.new(0,0,0,0), Color3.fromRGB(20,20,20), 0.15, UDim.new(0,0))
	local TitleLabel = Instance.new("TextLabel")
	TitleLabel.Size = UDim2.new(1,-50,1,0)
	TitleLabel.Position = UDim2.new(0,10,0,0)
	TitleLabel.BackgroundTransparency = 1
	TitleLabel.Text = title
	TitleLabel.TextColor3 = TEXT_COLOR
	TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	TitleLabel.Font = Enum.Font.SourceSansBold
	TitleLabel.TextSize = 18
	TitleLabel.Parent = TitleBar

	local CloseButton = Instance.new("TextButton")
	CloseButton.Size = UDim2.new(0,30,0,30)
	CloseButton.Position = UDim2.new(1,-30,0,0)
	CloseButton.BackgroundTransparency = 1
	CloseButton.Text = "X"
	CloseButton.TextColor3 = TEXT_COLOR
	CloseButton.Font = Enum.Font.SourceSansBold
	CloseButton.TextSize = 18
	CloseButton.Parent = TitleBar
	CloseButton.MouseButton1Click:Connect(function()
		Window:Destroy()
	end)

	-- Tabs
	local TabsFrame = Instance.new("Frame")
	TabsFrame.Size = UDim2.new(1,0,0,30)
	TabsFrame.Position = UDim2.new(0,0,0,30)
	TabsFrame.BackgroundTransparency = 1
	TabsFrame.Parent = Window

	local Tabs = {}
	local CurrentTabContent
	local Underline = createRoundedFrame(TabsFrame, UDim2.new(0,50,0,2), UDim2.new(0,0,1,-2), TEXT_COLOR, 0, UDim.new(0,1))

	local function addTab(name)
		local tabButton = Instance.new("TextButton")
		tabButton.Size = UDim2.new(0,100,1,0)
		tabButton.Position = UDim2.new(#Tabs*0.22,10,0,0)
		tabButton.BackgroundTransparency = 1
		tabButton.Text = name
		tabButton.TextColor3 = TEXT_COLOR
		tabButton.Font = Enum.Font.SourceSans
		tabButton.TextSize = 16
		tabButton.Parent = TabsFrame

		local tabContent = Instance.new("ScrollingFrame")
		tabContent.Size = UDim2.new(1,0,1,-60)
		tabContent.Position = UDim2.new(0,0,0,60)
		tabContent.BackgroundTransparency = 1
		tabContent.Visible = false
		tabContent.CanvasSize = UDim2.new(0,0,0,0)
		tabContent.ScrollBarThickness = 6
		tabContent.VerticalScrollBarInset = Enum.ScrollBarInset.ScrollBar
		tabContent.Parent = Window

		local layout = Instance.new("UIListLayout")
		layout.SortOrder = Enum.SortOrder.LayoutOrder
		layout.Padding = UDim.new(0,5)
		layout.Parent = tabContent

		layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			tabContent.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y + 5)
		end)

		local function activateTab()
			if CurrentTabContent then CurrentTabContent.Visible = false end
			tabContent.Visible = true
			CurrentTabContent = tabContent

			local textSize = tabButton.TextBounds.X
			local tabCenter = tabButton.AbsolutePosition.X + tabButton.AbsoluteSize.X/2
			local newPos = tabCenter - textSize/2 - TabsFrame.AbsolutePosition.X
			local newSize = UDim2.new(0,textSize,0,2)
			tween(Underline, {Position = UDim2.new(0,newPos,1,-2); Size=newSize}, 0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out):Play()
		end

		tabButton.MouseButton1Click:Connect(activateTab)
		table.insert(Tabs, tabButton)
		if #Tabs == 1 then activateTab() end

		return tabContent
	end

	-- Draggable
	local dragging, dragStart, startPos, dragInput = false
	TitleBar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = input.Position
			startPos = Window.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then dragging=false end
			end)
		end
	end)
	TitleBar.InputChanged:Connect(function(input)
		if input.UserInputType==Enum.UserInputType.MouseMovement then dragInput=input end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and input==dragInput then
			local delta = input.Position - dragStart
			Window.Position = UDim2.new(
				startPos.X.Scale, startPos.X.Offset+delta.X,
				startPos.Y.Scale, startPos.Y.Offset+delta.Y
			)
		end
	end)

	table.insert(Windows,Window)
	return Window, addTab
end

-- Notifications
local NotificationFolder = Instance.new("Folder")
NotificationFolder.Name = "Notifications"
NotificationFolder.Parent = UI

local function showNotification(text,duration)
	local notif = createRoundedFrame(NotificationFolder, UDim2.new(0,300,0,60), UDim2.new(1,-10,1,-10), Color3.fromRGB(0,0,0), 0.15, UDim.new(0,10))
	notif.AnchorPoint = Vector2.new(1,1)
	notif.ClipsDescendants = true

	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(1,-10,1,-15)
	label.Position = UDim2.new(0,5,0,5)
	label.BackgroundTransparency = 1
	label.Text = text
	label.TextColor3 = TEXT_COLOR
	label.TextWrapped = true
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Font = Enum.Font.SourceSans
	label.TextSize = 16
	label.Parent = notif

	local timerBar = createRoundedFrame(notif, UDim2.new(1,0,0,5), UDim2.new(0,0,1,-5), Color3.fromRGB(0,255,0), 0, UDim.new(0,2))

	table.insert(Notifications,notif)
	local index = #Notifications
	tween(notif, {Position=UDim2.new(1,-10,1,-10-(index-1)*70)}, 0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out):Play()

	local startTime = tick()
	local conn
	conn = RunService.RenderStepped:Connect(function()
		local elapsed = tick()-startTime
		local percent = math.clamp(1-elapsed/duration,0,1)
		timerBar.Size = UDim2.new(percent,0,0,5)
		if percent<=0 then
			tween(notif,{Position=UDim2.new(1,310,notif.Position.Y.Scale,notif.Position.Y.Offset)},0.3,Enum.EasingStyle.Quad,Enum.EasingDirection.In):Play()
			task.delay(0.3,function()
				notif:Destroy()
				table.remove(Notifications,1)
				for i,n in ipairs(NotificationFolder:GetChildren()) do
					tween(n,{Position=UDim2.new(1,-10,1,-10-(i-1)*70)},0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out):Play()
				end
			end)
			conn:Disconnect()
		end
	end)
end

-- Smooth slider
local function createSlider(parent,labelText,min,max,default)
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(1,-20,0,40)
	frame.Position = UDim2.new(0,10,0,50)
	frame.BackgroundTransparency = 1
	frame.Parent = parent

	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(0.4,0,1,0)
	label.BackgroundTransparency = 1
	label.Text = labelText
	label.TextColor3 = TEXT_COLOR
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Font = Enum.Font.SourceSans
	label.TextSize = 16
	label.Parent = frame

	local valueLabel = Instance.new("TextLabel")
	valueLabel.Size = UDim2.new(0.2,0,1,0)
	valueLabel.Position = UDim2.new(0.8,0,0,0)
	valueLabel.BackgroundTransparency = 1
	valueLabel.TextColor3 = TEXT_COLOR
	valueLabel.Font = Enum.Font.SourceSans
	valueLabel.TextSize = 16
	valueLabel.Text = tostring(default)
	valueLabel.TextXAlignment = Enum.TextXAlignment.Right
	valueLabel.Parent = frame

	local sliderBar = createRoundedFrame(frame, UDim2.new(0.6,0,0.3,0), UDim2.new(0.4,0,0.35,0), SLIDER_BG_COLOR,0, UDim.new(0,4))
	local sliderKnob = createRoundedFrame(sliderBar, UDim2.new(0,20,0,20), UDim2.new((default-min)/(max-min),0,0.5,0), SLIDER_COLOR,0, UDim.new(1,0))
	sliderKnob.AnchorPoint = Vector2.new(0.5,0.5)

	local dragging=false
	sliderKnob.InputBegan:Connect(function(input)
		if input.UserInputType==Enum.UserInputType.MouseButton1 then dragging=true end
	end)
	sliderKnob.InputEnded:Connect(function(input)
		if input.UserInputType==Enum.UserInputType.MouseButton1 then dragging=false end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and input.UserInputType==Enum.UserInputType.MouseMovement then
			local rel = math.clamp((input.Position.X-sliderBar.AbsolutePosition.X)/sliderBar.AbsoluteSize.X,0,1)
			TweenService:Create(sliderKnob,TweenInfo.new(0.1,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Position=UDim2.new(rel,0,0.5,0)}):Play()
			valueLabel.Text = tostring(math.floor(min + rel*(max-min)))
		end
	end)
end

-- Button
local function createButton(parent,text,callback)
	local button = Instance.new("TextButton")
	button.Size = UDim2.new(0.5,-10,0,40)
	button.Position = UDim2.new(0,10,0,100)
	button.BackgroundColor3 = BUTTON_COLOR
	button.BorderSizePixel = 0
	button.Text = text
	button.TextColor3 = TEXT_COLOR
	button.Font = Enum.Font.SourceSansBold
	button.TextSize = 16
	button.Parent = parent
	button.MouseButton1Click:Connect(callback)
end

-- Demo
local win, addTab = createWindow("Demo Window")
local tab1 = addTab("Main")
local tab2 = addTab("Misc")
local tab3 = addTab("Settings")

createSlider(tab1,"Volume",0,100,50)
createButton(tab1,"Notify Me",function() showNotification("Button clicked!",5) end)
createButton(tab2,"Misc Button",function() showNotification("Misc clicked!",4) end)
createButton(tab3,"Settings",function() showNotification("Settings clicked!",4) end)
