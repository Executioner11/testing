--!strict
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

local TEXT_COLOR = Color3.fromRGB(255,255,255)
local BLUEWARE_BLUE = Color3.fromRGB(0,140,255)
local WINDOW_BG_COLOR = Color3.fromRGB(0,0,0)

local UI = Instance.new("ScreenGui")
UI.Name = "BlueWare"
UI.ResetOnSpawn = false
UI.Parent = PlayerGui

local Notifications = {}

-- UTILITY FUNCTIONS
local function tween(obj, props, time, style, dir)
	return TweenService:Create(obj, TweenInfo.new(time, style, dir), props)
end

local function createRoundedFrame(parent, size, pos, bgColor, bgTransparency, cornerRadius)
	local frame = Instance.new("Frame")
	frame.Size = size
	frame.Position = pos
	frame.BackgroundColor3 = bgColor
	frame.BackgroundTransparency = bgTransparency or 0
	frame.BorderSizePixel = 0
	frame.Parent = parent

	local corner = Instance.new("UICorner")
	corner.CornerRadius = cornerRadius or UDim.new(0,10)
	corner.Parent = frame

	return frame
end

local function makeDraggable(window, dragArea)
	local dragging, dragStart, startPos
	dragArea.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = window.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then dragging = false end
			end)
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging then
			local delta = input.Position - dragStart
			window.Position = UDim2.new(
				startPos.X.Scale, startPos.X.Offset + delta.X,
				startPos.Y.Scale, startPos.Y.Offset + delta.Y
			)
		end
	end)
end

-- SLIDE ANIMATION
local function slideInWindow(window)
	window.Position = UDim2.new(0.5,-225,1,0)
	window.Visible = true
	tween(window,{Position=UDim2.new(0.5,-225,0.5,-150)},0.45,Enum.EasingStyle.Quad,Enum.EasingDirection.Out):Play()
end

local function slideOutWindow(window)
	local t = tween(window,{Position=UDim2.new(0.5,-225,1,0)},0.45,Enum.EasingStyle.Quad,Enum.EasingDirection.In)
	t:Play()
	t.Completed:Once(function() window.Visible=false end)
end

-- WINDOW CREATION
local function createWindow(title)
	local Window = createRoundedFrame(UI,UDim2.new(0,450,0,300),UDim2.new(0.5,-225,1,0),WINDOW_BG_COLOR,0.15)
	Window.Visible=false

	-- Title Bar
	local TitleBar = createRoundedFrame(Window,UDim2.new(1,0,0,30),UDim2.new(0,0,0,0),Color3.fromRGB(20,20,20),0.15,UDim.new(0,0))
	local Title = Instance.new("TextLabel",TitleBar)
	Title.Size=UDim2.new(1,-40,1,0)
	Title.Position=UDim2.new(0,10,0,0)
	Title.BackgroundTransparency=1
	Title.Text=title
	Title.Font=Enum.Font.SourceSansBold
	Title.TextSize=18
	Title.TextColor3=TEXT_COLOR
	Title.TextXAlignment=Enum.TextXAlignment.Left

	local Close = Instance.new("TextButton",TitleBar)
	Close.Size=UDim2.new(0,30,0,30)
	Close.Position=UDim2.new(1,-30,0,0)
	Close.BackgroundTransparency=1
	Close.Text="X"
	Close.Font=Enum.Font.SourceSansBold
	Close.TextSize=18
	Close.TextColor3=TEXT_COLOR
	Close.MouseButton1Click:Connect(function()
		slideOutWindow(Window)
	end)

	makeDraggable(Window,TitleBar)

	return Window
end

-- NOTIFICATIONS
local NotificationFolder = Instance.new("Folder")
NotificationFolder.Name = "Notifications"
NotificationFolder.Parent = UI

local function showNotification(text,duration)
	local notif = createRoundedFrame(NotificationFolder, UDim2.new(0,300,0,60), UDim2.new(1,-10,1,-10), Color3.fromRGB(0,0,0), 0.25, UDim.new(0,10))
	notif.AnchorPoint = Vector2.new(1,1)
	notif.ClipsDescendants = true

	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(1,-20,1,-15)
	label.Position = UDim2.new(0,10,0,5)
	label.BackgroundTransparency = 1
	label.Text = text
	label.TextColor3 = TEXT_COLOR
	label.TextWrapped = true
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Font = Enum.Font.SourceSans
	label.TextSize = 16
	label.Parent = notif

	local timerBar = createRoundedFrame(notif, UDim2.new(1,0,0,5), UDim2.new(0,0,1,-5), Color3.fromRGB(0,255,0), 0, UDim.new(0,2))

	table.insert(Notifications,notif)
	local index = #Notifications
	tween(notif, {Position=UDim2.new(1,-10,1,-10-(index-1)*70)}, 0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out):Play()

	local startTime = tick()
	local conn
	conn = RunService.RenderStepped:Connect(function()
		local elapsed = tick()-startTime
		local percent = math.clamp(1-elapsed/duration,0,1)
		timerBar.Size = UDim2.new(percent,0,0,5)
		if percent<=0 then
			tween(notif,{Position=UDim2.new(1,310,notif.Position.Y.Scale,notif.Position.Y.Offset)},0.3,Enum.EasingStyle.Quad,Enum.EasingDirection.In):Play()
			task.delay(0.3,function()
				notif:Destroy()
				table.remove(Notifications,1)
				for i,n in ipairs(NotificationFolder:GetChildren()) do
					tween(n,{Position=UDim2.new(1,-10,1,-10-(i-1)*70)},0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out):Play()
				end
			end)
			conn:Disconnect()
		end
	end)
end

-- BIG BLUE "B" BUTTON
local OpenButton = Instance.new("TextLabel")
OpenButton.Size = UDim2.new(0,60,0,60)
OpenButton.Position = UDim2.new(0,10,0.5,0)
OpenButton.BackgroundTransparency = 1
OpenButton.Text = "B"
OpenButton.TextColor3 = BLUEWARE_BLUE
OpenButton.Font = Enum.Font.SourceSansBold
OpenButton.TextSize = 50
OpenButton.Parent = UI
OpenButton.AnchorPoint = Vector2.new(0,0.5)
makeDraggable(OpenButton,OpenButton)

local opened=false

-- CREATE WINDOW
local win = createWindow("BlueWare")

OpenButton.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		opened = not opened
		if opened then slideInWindow(win) else slideOutWindow(win) end
	end
end)

showNotification("BlueWare Loaded",3)
